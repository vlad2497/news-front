(this["webpackJsonpstore-app"]=this["webpackJsonpstore-app"]||[]).push([[0],{102:function(e,t,a){},103:function(e,t,a){},104:function(e,t,a){},105:function(e,t,a){},114:function(e,t,a){},116:function(e,t,a){"use strict";a.r(t);var n=a(0),c=a.n(n),r=a(17),o=a.n(r),l=(a(48),a(14)),s=function(){return c.a.createElement("div",null,"Apps page")},i=function(){return c.a.createElement("div",null,"Music page")},u=a(15),m=a(12),p=a.n(m),f="0783ea48b34e4d558c3301f7857cd57b";p.a.defaults.baseURL="https://news-back.herokuapp.com";var g=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"gb",n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";return p.a.get("https://newsapi.org/v2/top-headlines",{params:{country:a,category:t,q:n,pageSize:8,page:e,apiKey:f}}).then((function(e){return e}))},h=(a(65),function(e){var t=e.title,a=e.urlToImage,n=e.description;return c.a.createElement("div",{className:"news-block"},c.a.createElement("h3",{className:"news-block__title"},t),c.a.createElement("img",{className:"news-block__img",src:a,alt:"news"}),c.a.createElement("div",{className:"news-block__description"},n))}),d=(a(66),function(e){var t=e.page,a=e.totalPages,n=e.setPage;return c.a.createElement("div",{className:"pagination"},c.a.createElement("div",{className:"pagination__arrow",onClick:function(){return n(t-1<0?0:t-1)}},"\u21e6"),c.a.createElement("div",{className:"pagination__arrow",onClick:function(){return n(t+1>a?a:t+1)}},"\u21e8"))}),v=a(20),E=a.n(v),b=a(25),_=a.n(b),k=[{label:"Russia",value:"ru"},{label:"England",value:"gb"}],w=[{label:"General",value:"general"},{label:"Business",value:"business"},{label:"Technology",value:"technology"}],N=function(){var e,t=Object(n.useState)([]),a=Object(u.a)(t,2),r=a[0],o=a[1],l=Object(n.useState)(1),s=Object(u.a)(l,2),i=s[0],m=s[1],p=Object(n.useState)(!0),f=Object(u.a)(p,2),v=f[0],b=f[1],N=Object(n.useState)(!0),O=Object(u.a)(N,2),j=O[0],S=O[1],y=Object(n.useState)(""),T=Object(u.a)(y,2),R=T[0],C=T[1],I=Object(n.useState)("gb"),q=Object(u.a)(I,2),x=q[0],L=q[1],P=Object(n.useState)(""),A=Object(u.a)(P,2),M=A[0],z=A[1];Object(n.useEffect)((function(){b(!0),g(i,R,x,M).then((function(e){o(e.data.articles),S(e.data.totalResults),b(!1)}))}),[i,R,x,M]);return c.a.createElement("div",null,c.a.createElement("div",{className:"filter-wrapper"},c.a.createElement("div",{className:"search"},c.a.createElement("input",{className:"search__input",type:"search",placeholder:"Enter keyword",onChange:function(t){return function(t){var a=t.target.value;clearTimeout(e),e=setTimeout((function(){z(a)}),1e3)}(t)}})),c.a.createElement("div",{className:"select"},c.a.createElement("div",{className:"select-wrapper"},c.a.createElement(_.a,{options:k,onChange:function(e){return function(e){L(e[0].value)}(e)},color:"#8aff",searchable:!1,placeholder:"Country",className:"select__item"})),c.a.createElement("div",{className:"select-wrapper"},c.a.createElement(_.a,{options:w,onChange:function(e){return function(e){C(e[0].value)}(e)},color:"#8aff",searchable:!1,placeholder:"Category",className:"select__item"})))),c.a.createElement("div",null,v?c.a.createElement("div",{className:"form-wrapper"},c.a.createElement(E.a,{type:"Puff",color:"#40e1d1",height:100,width:100,timeout:3e3})):c.a.createElement("div",{className:"news"},r.map((function(e){return c.a.createElement(h,{title:e.title,urlToImage:e.urlToImage,description:e.description,key:e.title})})))),c.a.createElement(d,{page:i,totalPages:j,setPage:m}))},O=a(5),j=a(13),S=a(21),y=a(22),T=a(2),R=function(e){var t=e.token_type,a=e.access_token,n=e.refresh_token,c=e.expires_in;localStorage.setItem("access_token","".concat(t," ").concat(a)),localStorage.setItem("refresh_token",n),localStorage.setItem("expires_in",c)},C=function(){localStorage.removeItem("access_token"),localStorage.removeItem("refresh_token"),localStorage.removeItem("expires_in")},I=function(e){p.a.defaults.headers.common.Authorization=e},q=function(){function e(){Object(S.a)(this,e),this.accessToken=localStorage.getItem("access_token"),this.user={},this.loading=!1,I(localStorage.getItem("access_token"))}return Object(y.a)(e,[{key:"loginRequest",value:function(e){var t=this;return new Promise((function(a,n){(function(e){return p.a.post("/api/login",e).then((function(e){return e}))})(e).then((function(e){var n=e.data,c=n.access_token,r=n.token_type;I("".concat(r," ").concat(c)),R(e.data),t.accessToken=c,t.userRequest(),a()})).catch((function(e){localStorage.removeItem("access_token"),t.accessToken="",n(e)}))}))}},{key:"logoutRequest",value:function(){var e=this;return new Promise((function(t,a){p.a.post("/api/logout").then((function(e){return e})).then((function(){C(),e.accessToken="",e.user={},t()})).catch((function(t){C(),e.accessToken="",e.user={},a(t)}))}))}},{key:"userRequest",value:function(){var e=this;p.a.get("/api/user").then((function(e){return e})).then((function(t){e.user=t.data,e.changeLoading(!1)})).catch((function(t){e.changeLoading(!1),401===t.response.status&&(localStorage.getItem("refresh_token")&&function(){var e=new Date,t=new Date;return e.setSeconds(localStorage.getItem("expires_in")),t<e}()?(e.changeLoading(!0),e.refreshRequest()):e.logoutRequest())}))}},{key:"refreshRequest",value:function(){var e=this;(function(){var e=localStorage.getItem("refresh_token");return p.a.post("/api/refresh",null,{headers:{refreshToken:e}}).then((function(e){return e}))})().then((function(t){var a=t.data,n=a.access_token,c=a.token_type;R(t.data),I("".concat(c," ").concat(n)),e.accessToken=n,e.userRequest()})).catch((function(){e.changeLoading(!1),e.logoutRequest()}))}},{key:"changeLoading",value:function(e){this.loading=e}}]),e}();Object(T.h)(q,{accessToken:T.m,user:T.m,userRequest:T.d,loginRequest:T.d,loading:T.m,changeLoading:T.d});var x=new q,L=function(){function e(){Object(S.a)(this,e),this.articles=[]}return Object(y.a)(e,[{key:"getArticles",value:function(){var e=this;g().then((function(t){e.articles=t.data.articles}))}}]),e}();Object(T.h)(L,{articles:T.m,getArticles:T.d});var P=new L,A=Object(n.createContext)({authStore:x,homeStore:P}),M=(a(99),Object(j.a)((function(e){e.match;var t=Object(l.g)(),a=Object(n.useContext)(A).authStore;return c.a.createElement("div",{className:"menu"},c.a.createElement("img",{className:"menu__img",src:"/logo.png",alt:"logo"}),c.a.createElement("ul",{className:"nav"},c.a.createElement("li",{className:"nav__link"},c.a.createElement(O.b,{to:"/admin/home"},"Home")),c.a.createElement("li",{className:"nav__link"},c.a.createElement(O.b,{to:"/admin/apps"},"Apps")),c.a.createElement("li",{className:"nav__link"},c.a.createElement(O.b,{to:"/admin/music"},"Music"))),c.a.createElement("div",{className:"menu__button-logout",onClick:function(){a.logoutRequest().then((function(){t.push("/login")}))}},"Logout"))}))),z=(a(102),function(){return c.a.createElement("div",{className:"footer"},c.a.createElement("ul",{className:"footer-links"},c.a.createElement("li",null,c.a.createElement(O.b,{to:"/admin/home"},"Home")),c.a.createElement("li",null,c.a.createElement(O.b,{to:"/admin/apps"},"Apps")),c.a.createElement("li",null,c.a.createElement(O.b,{to:"/admin/music"},"Music"))))}),B=function(e){var t=e.match;return c.a.createElement("div",null,c.a.createElement(M,null),c.a.createElement(l.b,{path:"".concat(t.path,"/home"),component:N}),c.a.createElement(l.b,{path:"".concat(t.path,"/apps"),component:s}),c.a.createElement(l.b,{path:"".concat(t.path,"/music"),component:i}),c.a.createElement(z,null))},D=a(23),H=(a(103),a(104),function(e){var t=e.input,a=e.meta;return c.a.createElement("div",{className:"input-wrapper"},c.a.createElement("label",{className:"input-wrapper__label"},"\u041b\u043e\u0433\u0438\u043d"),c.a.createElement("input",Object.assign({className:"input-wrapper__input",type:"text"},t)),a.error&&a.visited&&!a.active&&c.a.createElement("p",{className:"input-wrapper__error"},a.error))}),J=(a(105),function(e){var t=e.meta,a=e.input;return c.a.createElement("div",{className:"input-wrapper"},c.a.createElement("label",{className:"input-wrapper__label"},"\u041f\u0430\u0440\u043e\u043b\u044c"),c.a.createElement("input",Object.assign({className:"input-wrapper__input",type:"password"},a)),t.error&&t.visited&&!t.active&&c.a.createElement("p",{className:"input-wrapper__error"},t.error))}),G=a(19),K={errors:{email:"\u041b\u043e\u0433\u0438\u043d \u043e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u044b\u0439 \u0434\u043b\u044f \u0437\u0430\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f!",password:"\u041f\u0430\u0440\u043e\u043b\u044c \u043e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u044b\u0439 \u0434\u043b\u044f \u0437\u0430\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f!",incorrect:"\u041d\u0435\u0432\u0435\u0440\u043d\u044b\u0435 \u0434\u0430\u043d\u043d\u044b\u0435!"}},U=Object(j.a)((function(){var e=Object(n.useContext)(A).authStore,t=Object(l.g)();return Object.keys(e.user).length?c.a.createElement(l.a,{to:"/admin/home"}):e.loading?c.a.createElement("div",{className:"form-wrapper"},c.a.createElement(E.a,{type:"Puff",color:"#40e1d1",height:100,width:100,timeout:3e3})):c.a.createElement("div",{className:"form-wrapper"},c.a.createElement(D.b,{onSubmit:function(a){e.changeLoading(!0),e.loginRequest(a).then((function(){t.push("/admin/home")})).catch((function(){e.changeLoading(!1),G.ToastsStore.error(K.errors.incorrect)}))},validate:function(e){var t={};return e.email||(t.email=K.errors.email),e.password||(t.password=K.errors.password),t},render:function(e){var t=e.handleSubmit;return c.a.createElement("form",{onSubmit:t,className:"form login-form"},c.a.createElement("img",{className:"form__img",src:"/logo.png",alt:"logo"}),c.a.createElement("h2",{className:"form__title"},"\u0412\u0445\u043e\u0434"),c.a.createElement(D.a,{name:"email",component:H}),c.a.createElement(D.a,{name:"password",component:J}),c.a.createElement("button",{className:"form__submit",type:"submit"},"\u0412\u043e\u0439\u0442\u0438"))}}),c.a.createElement(G.ToastsContainer,{store:G.ToastsStore,position:G.ToastsContainerPosition.TOP_CENTER,color:"white"}))})),F=(a(114),a(42)),Q=Object(j.a)((function(e){var t=e.component,a=Object(F.a)(e,["component"]),r=Object(n.useContext)(A).authStore;return c.a.createElement(l.b,Object.assign({},a,{render:function(e){return Object.keys(r.user).length?c.a.createElement(t,e):c.a.createElement(l.a,{to:"/login"})}}))}));var V=function(){return c.a.createElement("div",null,"\u0422\u0430\u043a\u043e\u0439 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u044b \u043d\u0435\u0442...")},W=(a(115),Object(j.a)((function(){var e=Object(n.useContext)(A).authStore;return Object(n.useEffect)((function(){e.accessToken&&(e.changeLoading(!0),e.userRequest())})),c.a.createElement("div",null,c.a.createElement(l.d,null,c.a.createElement(l.b,{path:"/login",component:U}),c.a.createElement(Q,{path:"/admin",component:B}),c.a.createElement(l.b,{path:"*"},c.a.createElement(V,null))))})));o.a.render(c.a.createElement(O.a,null,c.a.createElement(W,null)),document.getElementById("root"))},43:function(e,t,a){e.exports=a(116)},48:function(e,t,a){},65:function(e,t,a){},66:function(e,t,a){},99:function(e,t,a){}},[[43,1,2]]]);
//# sourceMappingURL=main.709bae6a.chunk.js.map